
  LIST(APPEND DIAMOND2_SCALARS "totenergy" "-21.668293 0.007")
  LIST(APPEND DIAMOND2_SCALARS "kinetic" "20.065151 0.044")
  LIST(APPEND DIAMOND2_SCALARS "potential" "-41.733377 0.045")
  LIST(APPEND DIAMOND2_SCALARS "eeenergy" "-5.428561 0.012")
  LIST(APPEND DIAMOND2_SCALARS "ionion" "-25.5513269 0.001")
  LIST(APPEND DIAMOND2_SCALARS "localecp" "-12.29402 0.051")
  LIST(APPEND DIAMOND2_SCALARS "nonlocalecp" "1.540530 0.018")
  LIST(APPEND DIAMOND2_SCALARS "samples" "32000 0.0")
#  LIST(APPEND DIAMOND2_SCALARS "flux" "0.0 0.7")

  QMC_RUN_AND_CHECK(short-diamondC_2x1x1_pp-vmc_sdj
                    "${CMAKE_SOURCE_DIR}/tests/solids/diamondC_2x1x1_pp"
                    qmc_short
                    qmc_short.in.xml
                    1 16
                    TRUE
                    0 DIAMOND2_SCALARS # VMC
                    )

  QMC_RUN_AND_CHECK(short-diamondC_2x1x1_pp-delayed_update-vmc_sdj
                    "${CMAKE_SOURCE_DIR}/tests/solids/diamondC_2x1x1_pp"
                    qmc_short
                    qmc_short_delayedupdate.in.xml
                    1 16
                    TRUE
                    0 DIAMOND2_SCALARS # VMC
                    )

IF(ENABLE_SOA OR QMC_CUDA)
  QMC_RUN_AND_CHECK(short-diamondC_2x1x1_hybridrep_pp-vmc_sdj
                    "${CMAKE_SOURCE_DIR}/tests/solids/diamondC_2x1x1_pp"
                    qmc_short
                    qmc_short_hybridrep.in.xml
                    1 16
                    TRUE
                    0 DIAMOND2_SCALARS # VMC
                    )
ELSE()
  MESSAGE("Skipping diamondC_2x1x1_hybridrep_pp-vmc_sdj test because neither SOA nor CUDA is enabled")
ENDIF()

# Reference DMC run in qmc-ref "-21.844975 0.001113"
  LIST(APPEND DIAMOND2_DMC_SCALARS "totenergy" "-21.844975 0.00779")
  QMC_RUN_AND_CHECK(short-diamondC_2x1x1_pp-dmc_sdj
                    "${CMAKE_SOURCE_DIR}/tests/solids/diamondC_2x1x1_pp"
                    qmc_short_vmc_dmc
                    qmc_short_vmc_dmc.in.xml
                    1 16
                    TRUE
                    1 DIAMOND2_DMC_SCALARS # DMC
                    )

  LIST(APPEND DIAMOND2_DMC_SCALARS "totenergy" "-21.844975 0.00779")
  QMC_RUN_AND_CHECK(short-diamondC_2x1x1_pp-dmc-reconf_sdj
                    "${CMAKE_SOURCE_DIR}/tests/solids/diamondC_2x1x1_pp"
                    qmc_short_vmc_dmc
                    qmc_short_vmc_dmc_reconf.in.xml
                    1 16
                    TRUE
                    1 DIAMOND2_DMC_SCALARS # DMC
                    )


#
# Long tests
#

  LIST(APPEND LONG_DIAMOND2_SCALARS "totenergy" "-21.668293 0.00023")
  LIST(APPEND LONG_DIAMOND2_SCALARS "samples" "30720000 0.0")
  LIST(APPEND LONG_DIAMOND2_SCALARS "flux" "0.0 0.05")

  QMC_RUN_AND_CHECK(long-diamondC_2x1x1_pp-vmc_sdj
                    "${CMAKE_SOURCE_DIR}/tests/solids/diamondC_2x1x1_pp"
                    qmc_long
                    qmc_long.in.xml
                    1 16
                    TRUE
                    0 LONG_DIAMOND2_SCALARS # VMC
                    )

# Reference DMC run in qmc-ref "-21.844975 0.001113"
  LIST(APPEND LONG_DIAMOND2_DMC_SCALARS "totenergy" "-21.844975 0.002879")
  QMC_RUN_AND_CHECK(long-diamondC_2x1x1_pp-dmc_sdj
                    "${CMAKE_SOURCE_DIR}/tests/solids/diamondC_2x1x1_pp"
                    qmc_long_vmc_dmc
                    qmc_long_vmc_dmc.in.xml
                    1 16
                    TRUE
                    1 LONG_DIAMOND2_DMC_SCALARS # DMC
                    )

  QMC_RUN_AND_CHECK(long-diamondC_2x1x1_pp-dmc-reconf_sdj
                    "${CMAKE_SOURCE_DIR}/tests/solids/diamondC_2x1x1_pp"
                    qmc_long_vmc_dmc
                    qmc_long_vmc_dmc_reconf.in.xml
                    1 16
                    TRUE
                    1 LONG_DIAMOND2_DMC_SCALARS # DMC
                    )


#
# Deterministic tests
#

# VMC RUN
IF(QMC_MIXED_PRECISION)
  IF(QMC_COMPLEX)
   LIST(APPEND DET_DIAMOND2_SCALARS "totenergy" "-22.30283274 0.0001801")
   LIST(APPEND DET_DIAMOND2_SCALARS "kinetic" "19.25965947 0.00098725")
   LIST(APPEND DET_DIAMOND2_SCALARS "potential" "-41.56249222 0.0008072")
   LIST(APPEND DET_DIAMOND2_SCALARS "eeenergy" "-7.25691718 0.000197")
   LIST(APPEND DET_DIAMOND2_SCALARS "ionion" "-25.55132676 0.00003475")
   LIST(APPEND DET_DIAMOND2_SCALARS "localecp" "-10.85078393 0.00173875")
   LIST(APPEND DET_DIAMOND2_SCALARS "nonlocalecp" "2.09653564 0.00073155")
   LIST(APPEND DET_DIAMOND2_SCALARS "samples" "9.00000000 0.0")
   LIST(APPEND DET_DIAMOND2_SCALARS "flux" "-5.34634371 0.00361125")
  ELSE()
   LIST(APPEND DET_DIAMOND2_SCALARS "totenergy" "-22.29890271 0.00037045")
   LIST(APPEND DET_DIAMOND2_SCALARS "kinetic" "19.26597773 0.00110815")
   LIST(APPEND DET_DIAMOND2_SCALARS "potential" "-41.56488044 0.0007377")
   LIST(APPEND DET_DIAMOND2_SCALARS "eeenergy" "-7.25613869 0.00019155")
   LIST(APPEND DET_DIAMOND2_SCALARS "ionion" "-25.55132676 0.00003475")
   LIST(APPEND DET_DIAMOND2_SCALARS "localecp" "-10.85686146 0.0017008")
   LIST(APPEND DET_DIAMOND2_SCALARS "nonlocalecp" "2.09944647 0.00076535")
   LIST(APPEND DET_DIAMOND2_SCALARS "samples" "9.00000000 0.0")
   LIST(APPEND DET_DIAMOND2_SCALARS "flux" "-5.36609515 0.00323615")
  ENDIF()
ELSE()
  IF(QMC_COMPLEX)
   LIST(APPEND DET_DIAMOND2_SCALARS "totenergy" "-22.30283274 0.000001")
   LIST(APPEND DET_DIAMOND2_SCALARS "kinetic" "19.25965947 0.000001")
   LIST(APPEND DET_DIAMOND2_SCALARS "potential" "-41.56249222 0.000001")
   LIST(APPEND DET_DIAMOND2_SCALARS "eeenergy" "-7.25691718 0.000001")
   LIST(APPEND DET_DIAMOND2_SCALARS "ionion" "-25.55132676 0.000001")
   LIST(APPEND DET_DIAMOND2_SCALARS "localecp" "-10.85078393 0.000001")
   LIST(APPEND DET_DIAMOND2_SCALARS "nonlocalecp" "2.09653564 0.000001")
   LIST(APPEND DET_DIAMOND2_SCALARS "samples" "9.00000000 0.0")
   LIST(APPEND DET_DIAMOND2_SCALARS "flux" "-5.34634371 0.000001")
  ELSE()
   LIST(APPEND DET_DIAMOND2_SCALARS "totenergy" "-22.29890271 0.000001")
   LIST(APPEND DET_DIAMOND2_SCALARS "kinetic" "19.26597773 0.000001")
   LIST(APPEND DET_DIAMOND2_SCALARS "potential" "-41.56488044 0.000001")
   LIST(APPEND DET_DIAMOND2_SCALARS "eeenergy" "-7.25613869 0.000001")
   LIST(APPEND DET_DIAMOND2_SCALARS "ionion" "-25.55132676 0.000001")
   LIST(APPEND DET_DIAMOND2_SCALARS "localecp" "-10.85686146 0.000001")
   LIST(APPEND DET_DIAMOND2_SCALARS "nonlocalecp" "2.09944647 0.000001")
   LIST(APPEND DET_DIAMOND2_SCALARS "samples" "9.00000000 0.0")
   LIST(APPEND DET_DIAMOND2_SCALARS "flux" "-5.36609515 0.000001")
  ENDIF()
ENDIF()

  QMC_RUN_AND_CHECK(deterministic-diamondC_2x1x1_pp-vmc_sdj
                    "${CMAKE_SOURCE_DIR}/tests/solids/diamondC_2x1x1_pp"
                    det_qmc_short
                    det_qmc_short.in.xml
                    1 1
                    TRUE
                    0 DET_DIAMOND2_SCALARS # VMC
                    )

# VMC DELAYED-UPDATE
IF(QMC_MIXED_PRECISION)
  IF(QMC_COMPLEX)
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "totenergy" "-20.94752145 0.00005575")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "kinetic" "16.53205375 0.0000611")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "potential" "-37.47957520 0.00003125")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "eeenergy" "-4.25515766 0.00002585")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "ionion" "-25.55132676 0.00003475")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "localecp" "-9.39410085 0.00004855")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "nonlocalecp" "1.72101007 0.00001215")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "samples" "9.00000000 0.0")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "flux" "-12.47274689 0.000119")
  ELSE()
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "totenergy" "-20.94387935 0.0000773")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "kinetic" "16.53547309 0.0000911")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "potential" "-37.47935243 0.00008215")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "eeenergy" "-4.25504502 0.00004625")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "ionion" "-25.55132676 0.00003475")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "localecp" "-9.39386209 0.00011375")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "nonlocalecp" "1.72088142 0.0000388")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "samples" "9.00000000 0.0")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "flux" "-12.48031692 0.00006995")
  ENDIF()
ELSE()
  IF(QMC_COMPLEX)
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "totenergy" "-20.94752145 0.000001")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "kinetic" "16.53205375 0.000001")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "potential" "-37.47957520 0.000001")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "eeenergy" "-4.25515766 0.000001")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "ionion" "-25.55132676 0.000001")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "localecp" "-9.39410085 0.000001")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "nonlocalecp" "1.72101007 0.000001")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "samples" "9.00000000 0.0")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "flux" "-12.47274689 0.000001")
  ELSE()  
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "totenergy" "-20.94387935 0.000001")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "kinetic" "16.53547309 0.000001")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "potential" "-37.47935243 0.000001")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "eeenergy" "-4.25504502 0.000001")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "ionion" "-25.55132676 0.000001")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "localecp" "-9.39386209 0.000001")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "nonlocalecp" "1.72088142 0.000001")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "samples" "9.00000000 0.0")
   LIST(APPEND DET_DIAMOND2_DELAY_SCALARS "flux" "-12.48031692 0.000001")
  ENDIF()
ENDIF()  

  QMC_RUN_AND_CHECK(deterministic-diamondC_2x1x1_pp-delayed_update-vmc_sdj
                    "${CMAKE_SOURCE_DIR}/tests/solids/diamondC_2x1x1_pp"
                    det_qmc_short
                    det_qmc_short_delayedupdate.in.xml
                    1 1
                    TRUE
                    0 DET_DIAMOND2_DELAY_SCALARS # VMC
                    )

# DMC RUN
IF(QMC_MIXED_PRECISION)
  IF(QMC_COMPLEX)
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "totenergy" "-21.04525132 0.0000621")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "kinetic" "22.67697372 0.0001428")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "potential" "-43.72222505 0.00023535")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "eeenergy" "-6.17624438 0.0000247")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "ionion" "-25.55132676 0.00003475")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "localecp" "-9.10929967 0.0001135")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "nonlocalecp" "-2.88535424 0.0000541")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "samples" "9.00000000 0.0")
  ELSE() 
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "totenergy" "-21.05325436 0.00006475")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "kinetic" "22.66901302 0.00013525")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "potential" "-43.72226738 0.0001048")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "eeenergy" "-6.17624150 0.00001515")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "ionion" "-25.55132676 0.00003475")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "localecp" "-9.10934270 0.00004455")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "nonlocalecp" "-2.88535642 0.00007535")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "samples" "9.00000000 0.0")
  ENDIF()
ELSE()
  IF(QMC_COMPLEX)
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "totenergy" "-21.04525132 0.000001")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "kinetic" "22.67697372 0.000001")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "potential" "-43.72222505 0.000001")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "eeenergy" "-6.17624438 0.000001")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "ionion" "-25.55132676 0.000001")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "localecp" "-9.10929967 0.000001")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "nonlocalecp" "-2.88535424 0.000001")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "samples" "9.00000000 0.0")
  ELSE()
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "totenergy" "-21.05325436 0.000001")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "kinetic" "22.66901302 0.000001")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "potential" "-43.72226738 0.000001")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "eeenergy" "-6.17624150 0.000001")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "ionion" "-25.55132676 0.000001")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "localecp" "-9.10934270 0.000001")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "nonlocalecp" "-2.88535642 0.000001")
   LIST(APPEND DET_DIAMOND2_DMC_SCALARS "samples" "9.00000000 0.0")
  ENDIF()
ENDIF()

  QMC_RUN_AND_CHECK(deterministic-diamondC_2x1x1_pp-dmc_sdj
                    "${CMAKE_SOURCE_DIR}/tests/solids/diamondC_2x1x1_pp"
                    det_qmc_short_vmc_dmc
                    det_qmc_short_vmc_dmc.in.xml
                    1 1
                    TRUE
                    1 DET_DIAMOND2_DMC_SCALARS # DMC
                    )
